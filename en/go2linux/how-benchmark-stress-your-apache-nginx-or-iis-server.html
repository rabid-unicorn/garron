<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- SEO includes -->
        
<link href="/en/atom.xml" rel="alternate" title="Guillermo Garron" type="application/atom+xml" />


        <link rel="canonical" href="http://www.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html" />
        
<meta name="robots" content="noopd, noydir" />


<meta name="description" content="How to perform stress tests on Web servers. Works for Apache, Nginx, Cherokee, IIS or any other" />

        <!-- End SEO includes -->
        <title>How to benchmark, Stress, your Apache, Nginx or IIS server</title>
        <!-- <link rel="stylesheet" href="/foundation/css/foundation.css" /> -->
        <link rel="stylesheet" href="//cdn.jsdelivr.net/foundation/5.5.1/css/foundation.min.css" />
        <link rel="stylesheet" href="/foundation/css/app.css">
        <link href='http://fonts.googleapis.com/css?family=Josefin+Slab|Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/webfonts/ss-social-circle.css" type="text/css">
        <!-- <link href="/bootstrap/css/magnific-popup.css" rel="stylesheet"> -->
        <link href="//cdn.jsdelivr.net/jquery.magnific-popup/1.0.0/magnific-popup.css" rel="stylesheet">
        <!-- Twitter cards -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@ggarron">
        <meta name="twitter:creator" content="@ggarron">
        <meta name="twitter:title" content="How to benchmark, Stress, your Apache, Nginx or IIS server">
        <meta name="twitter:description" content="How to perform stress tests on Web servers. Works for Apache, Nginx, Cherokee, IIS or any other">
        <!-- End Twitter Cards -->
        <!-- FB property -->
        <meta property="fb:admins" content="613797474" />
        <!-- End FB Property -->
        <!-- <script src="/foundation/js/vendor/modernizr.js"></script> -->
        <script src="//cdn.jsdelivr.net/foundation/5.5.1/js/vendor/modernizr.js"></script>
    </head>
    <body>
        
        
        <div class="row">
    <div class="contain-to-grid sticky"> 
        <nav class="top-bar" data-topbar role="navigation" data-options="sticky_on: large">
            <ul class="title-area">
                <li class="name">
                    <h1><a href="/en/">Home</a></h1>
                </li>
                <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
            </ul>
            <section class="top-bar-section">
                <ul class="left">
                    <li><a href="/en/linux/">Linux</a></li>
                    <li><a href="/en/mac/">Mac</a></li>
                    <li><a href="/en/bits/">Tips</a></li>
                    <li><a href="/en/tech/">Tech</a></li>
                    <li><a href="/en/articles/">Articles</a></li>
                    <li><a href="/en/blog/">Blog</a></li>
                    <li><a href="/en/food/">Food</a></li>
                    <li><a href="/en/pictures/">Photos</a></li>
                    <li><a href="/en/projects/">Projects</a></li>
                    <li><a href="/en/web-design/">Web Designg</a></li>
                </ul>
            </section>
        </nav> 
    </div>
</div>
<div class="row">
    <div class="large-12 columns">
        <hr>
        <p>Get updates via: <a href="/en/atom.xml" class="ss-icon ss-social-circle">rss</a> | <a href="http://twitter.com/ggarron" class="ss-icon ss-social-circle">twitter</a> | <a href="http://feedburner.google.com/fb/a/mailverify?uri=GuillermoGarronMainSite&amp;loc=en_US" class="ss-icon ss-social-circle">email</a> | <a href="https://plus.google.com/u/0/115745027821234071812" class="ss-icon ss-social-circle">google+</a></p>
        <ul class="breadcrumbs">
            
            <li><a href="/index.html">Geeking</a>
            <li class="divider">&gt;</li>
            
            <li><a href="/en/index.html">Tech Blog</a>
            <li class="divider">&gt;</li>
            
            <li><a href="/en/go2linux/index.html">Go2Linux</a>
            <li class="divider">&gt;</li>
            
            <li class="active">How to benchmark, Stress, your Apache, Nginx or IIS server</li>
        </ul>
    </div>
</div>
<div class="row">
    <div class="small-12 large-9 large-centered medium-9 medium-centered columns">
        <h3><a href="/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html">How to benchmark, Stress, your Apache, Nginx or IIS server</a></h3>
<h6>Written by <a href="/en/about.html">Guillermo Garron</a> .</h6>
<h6>Date: 2010-04-10 10:36:30 -0400</h6>

        <hr>
        <p><small>Tags: <a href="/en/tag/tutorial.html">tutorial</a>,</small></p>

<hr>
<p>When your run a webserver, which could be Apache, Nginx or Lighttpd, you may want to know how it is performing.</p>

<p>Actually usually any web server can handle a normal day of work, but what happens when the server under your administration gets, stumbled, or appears in Slashdot, or digg front pages, now a days even twitter may drive a lot of traffic to a webpage.</p>

<p>If that event occurs your server will be under real stress, and it is in that day when you want it to perform well, and survive the “attack”.</p>

<p>It is usually not possible to know how it will do that day, until the D. day arrives, but you can figure out how it will be.</p>

<p>We will use ab, which is a tool that comes with Apache is the Apache Benchmarking tool.</p>

<p>First let’s see what we need.</p>

<ul>
  <li>The server you want to test with some different files</li>
  <li>Simple html file</li>
  <li>Simple php file</li>
  <li>Simple image file</li>
  <li>Another computer with Apache installed (The one which will run the ab test)
Be sure to have a good Bandwidth between the two of them, you can use iperf to check the network connection before</li>
</ul>

<p>Lets create the files we are going to use for testing.</p>

<p><em>The .html file</em></p>

<pre><code>&lt;html&gt;
&lt;title&gt;Simple HTML file for testing server&lt;/title&gt;
&lt;h1&gt;Heading number 1&lt;/h1&gt;
&lt;p&gt;With this file I will test an Apache server&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.go2linux.org"&gt;Linux Operating System&lt;/p&gt;
&lt;/html&gt;
</code></pre>

<p><em>The .php file</em></p>

<pre><code>&lt;html&gt;
&lt;Title&gt;PHP info&lt;/title&gt;
&lt;?php

// Show all information, defaults to INFO_ALL
phpinfo();

// Show just the module information.
// phpinfo(8) yields identical results.
phpinfo(INFO_MODULES);

?&gt;
&lt;/html&gt;
</code></pre>

<p><em>The image file</em></p>

<p>The image file is a .jpg file of 72252 bytes</p>

<p><strong>Now go with the tests</strong></p>

<p>It is assumed that you have put those files in the server you want to test, I have put myself in /tmp/ directory under the root directory of my server.</p>

<pre><code>ab -kc 1000 -n 10000 http://www.some-site.cc/tmp/index.html
</code></pre>

<p>This will send 1000 concurrent connections 10.000 times, the results are shown like this.</p>

<pre><code>This is ApacheBench, Version 2.0.41-dev &lt;$Revision: 1.141 $&gt; apache-2.0       
Copyright (c) 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/  
Copyright (c) 2006 The Apache Software Foundation, http://www.apache.org/     

Benchmarking www.some-site.cc (be patient)
Completed 1000 requests
Completed 2000 requests
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Finished 10000 requests


Server Software:        Apache/2.2.9
Server Hostname:        www.some-site.cc
Server Port:            80

Document Path:          /tmp/index.html
Document Length:        207 bytes

Concurrency Level:      1000
Time taken for tests:   6.571282 seconds
Complete requests:      10000
Failed requests:        0
Write errors:           0
Keep-Alive requests:    9923
Total transferred:      5744865 bytes
HTML transferred:       2083869 bytes
Requests per second:    1521.77 [#/sec] (mean)
Time per request:       657.128 [ms] (mean)
Time per request:       0.657 [ms] (mean, across all concurrent requests)
Transfer rate:          853.71 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    3  26.1      0     225
Processing:     1   69 482.3     12    5947
Waiting:        0   68 482.3     12    5946
Total:          1   72 504.3     12    6143

Percentage of the requests served within a certain time (ms)
  50%     12
  66%     17
  75%     21
  80%     21
  90%     37
  95%     39
  98%    130
  99%   2647
 100%   6143 (longest request)
</code></pre>

<p>Now run it with the php file.</p>

<pre><code>ab -kc 1000 -n 10000 http://www.some-site.cc/tmp/index.php
</code></pre>

<p>The results are:</p>

<pre><code>This is ApacheBench, Version 2.0.41-dev &lt;$Revision: 1.141 $&gt; apache-2.0      
Copyright (c) 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ 
Copyright (c) 2006 The Apache Software Foundation, http://www.apache.org/    

Benchmarking www.some-site.cc (be patient)
Completed 1000 requests                   
Completed 2000 requests                   
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Finished 10000 requests


Server Software:        Apache/2.2.9
Server Hostname:        www.some-site.cc
Server Port:            80

Document Path:          /tmp/index.php
Document Length:        62446 bytes

Concurrency Level:      1000
Time taken for tests:   157.530617 seconds
Complete requests:      10000
Failed requests:        21
   (Connect: 0, Length: 21, Exceptions: 0)
Write errors:           0
Keep-Alive requests:    0
Total transferred:      628658346 bytes
HTML transferred:       626254006 bytes
Requests per second:    63.48 [#/sec] (mean)
Time per request:       15753.062 [ms] (mean)
Time per request:       15.753 [ms] (mean, across all concurrent requests)
Transfer rate:          3897.17 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0 3898 9601.3    132   93114
Processing:   711 4816 9077.5   2852  151641
Waiting:       96 4079 8403.1   2434  147921
Total:        964 8715 13258.0   4959  152406

Percentage of the requests served within a certain time (ms)
  50%   4959
  66%   6265
  75%   8895
  80%  11189
  90%  19319
  95%  25519
  98%  50649
  99%  69027
 100%  152406 (longest request)
</code></pre>

<p>And finally go for the image file, the results are:</p>

<pre><code>This is ApacheBench, Version 2.0.41-dev &lt;$Revision: 1.141 $&gt; apache-2.0               
Copyright (c) 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/          
Copyright (c) 2006 The Apache Software Foundation, http://www.apache.org/             
	
Benchmarking www.some-site.cc (be patient)
Completed 1000 requests
Completed 2000 requests
Completed 3000 requests
Completed 4000 requests
Completed 5000 requests
Completed 6000 requests
Completed 7000 requests
Completed 8000 requests
Completed 9000 requests
Finished 10000 requests


Server Software:        Apache/2.2.9
Server Hostname:        www.some-site.cc
Server Port:            80

Document Path:          /tmp/38_TaylorSwift.jpg
Document Length:        72252 bytes

Concurrency Level:      1000
Time taken for tests:   30.131674 seconds
Complete requests:      10000
Failed requests:        0
Write errors:           0
Keep-Alive requests:    10000
Total transferred:      730617980 bytes
HTML transferred:       726894150 bytes
Requests per second:    331.88 [#/sec] (mean)
Time per request:       3013.167 [ms] (mean)
Time per request:       3.013 [ms] (mean, across all concurrent requests)
Transfer rate:          23679.20 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    5  49.6      0     552
Processing:   311  440 153.4    422    5346
Waiting:        7  190 172.0    201    4912
Total:        311  446 184.0    422    5898

Percentage of the requests served within a certain time (ms)
  50%    422
  66%    433
  75%    455
  80%    460
  90%    474
  95%    496
  98%    566
  99%    820
 100%   5898 (longest request)
</code></pre>

<p>Now let’s have the output explained, the most of it is self explaining, but let’s go to some of the most important points you may care about.</p>

<p><strong>For the html file</strong></p>

<ul>
  <li>Requests per second:    1521.77 [#/sec] (mean)</li>
  <li>Time per request:       657.128 [ms] (mean)</li>
</ul>

<p><strong>For the php file</strong></p>

<ul>
  <li>Requests per second:    63.48 [#/sec] (mean)</li>
  <li>Time per request:       15753.062 [ms] (mean)</li>
</ul>

<p><strong>For the image file</strong></p>

<ul>
  <li>Requests per second:    331.88 [#/sec] (mean)</li>
  <li>Time per request:       3013.167 [ms] (mean)</li>
</ul>

<p>As you can see, for a single .html file the server can serve 1521 requests per second, for the image size it can 331 requests per second, mostly because of the size of the image, but for the .php it can only attend 63 requests per second, because it involves too much CPU work, If MySQL would be involved, we might see an even poorer performance, the time per request is also another good parameter to look at, as it lets you see the time the server needs to send the page to the user.</p>

<p>would be a good idea to also run htop while running the “traffic generator” test over the web server.</p>

<p>That way, you will also see how your CPU is managing the load, here is an example of how this small vmware on Debian server is doing its job.</p>

<p><img src="/images/2010/04/htop-apache.png" class="img-responsive" alt="htop" /></p>

<p>u can see that the CPU is working at 100%, and the cpu load is over 40, so it is really stressed.</p>


<hr>
<a href="http://www.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html">permalink</a>
<hr>
<p>If you enjoyed the article, please share it</a>
<p><a class="ss-icon ss-social-circle" href="http://twitter.com/intent/tweet?url=http://www.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html&text=How to benchmark, Stress, your Apache, Nginx or IIS server&via=ggarron">twitter</a> | <a class="ss-icon ss-social-circle" href="http://facebook.com/sharer.php?u=http://www.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html">facebook</a> | <a class="ss-icon ss-social-circle" href="https://plus.google.com/share?url=http%3A%2F%2Fwww.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html">google+</a> | <a class="ss-icon ss-social-circle" href="http://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Fwww.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html">linkedin</a> | <a href="mailto:?Subject=How to benchmark, Stress, your Apache, Nginx or IIS server&Body=http://www.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html" class="ss-icon ss-social-circle">email</a> | <a href="http://reddit.com/submit?url=http://www.garron.me/en/go2linux/how-benchmark-stress-your-apache-nginx-or-iis-server.html&title=How to benchmark, Stress, your Apache, Nginx or IIS server" class="ss-icon ss-social-circle">reddit</a></p>

<hr>
<!-- <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'garronblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> -->


    </div>
</div>
      
        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <!-- <script src="/foundation/js/vendor/jquery.js"></script> -->
        <!-- <script src="/foundation/js/foundation.min.js"></script> -->
        <script src="//cdn.jsdelivr.net/foundation/5.5.1/js/foundation.min.js"></script>
        <!-- <script src="/foundation/js/rainbow.min.js"></script> -->
        <script src="//cdn.jsdelivr.net/rainbow/1.1.9/rainbow.min.js"></script>
        <!-- <script src="/bootstrap/js/magnific-popup.js"></script> -->
        <script src="//cdn.jsdelivr.net/jquery.magnific-popup/1.0.0/jquery.magnific-popup.min.js"></script>
        <!-- To start magnific popup -->
        <script src="/bootstrap/js/custom.js"></script>
        <script>
          $(document).foundation();
        </script>
        <!-- Analytics -->
        <!-- <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1514170-11']);
  _gaq.push(['_setDomainName', 'www.garron.me']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>    -->
        <!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//piwik.go2linux.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src='http://d2lx14ao1t3d4g.cloudfront.net/piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//piwik.go2linux.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->



        <!-- end analytics -->
    </body>
</html>
