<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- SEO includes -->
        
<link href="/en/atom.xml" rel="alternate" title="Guillermo Garron" type="application/atom+xml" />


        <link rel="canonical" href="http://www.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html" />
        
<meta name="robots" content="noopd, noydir" />


<meta name="description" content="How to increase the performance of MySQL using query cache" />

        <!-- End SEO includes -->
        <title>Increase MySQL performance with query cache query_cache</title>
        <!-- <link rel="stylesheet" href="/foundation/css/foundation.css" /> -->
        <link rel="stylesheet" href="//cdn.jsdelivr.net/foundation/5.5.1/css/foundation.min.css" />
        <link rel="stylesheet" href="/foundation/css/app.css">
        <link href='http://fonts.googleapis.com/css?family=Josefin+Slab|Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/webfonts/ss-social-circle.css" type="text/css">
        <!-- <link href="/bootstrap/css/magnific-popup.css" rel="stylesheet"> -->
        <link href="//cdn.jsdelivr.net/jquery.magnific-popup/1.0.0/magnific-popup.css" rel="stylesheet">
        <!-- Twitter cards -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@ggarron">
        <meta name="twitter:creator" content="@ggarron">
        <meta name="twitter:title" content="Increase MySQL performance with query cache query_cache">
        <meta name="twitter:description" content="How to increase the performance of MySQL using query cache">
        <!-- End Twitter Cards -->
        <!-- FB property -->
        <meta property="fb:admins" content="613797474" />
        <!-- End FB Property -->
        <!-- <script src="/foundation/js/vendor/modernizr.js"></script> -->
        <script src="//cdn.jsdelivr.net/foundation/5.5.1/js/vendor/modernizr.js"></script>
    </head>
    <body>
        
        
        <div class="row">
    <div class="contain-to-grid sticky"> 
        <nav class="top-bar" data-topbar role="navigation" data-options="sticky_on: large">
            <ul class="title-area">
                <li class="name">
                    <h1><a href="/en/">Home</a></h1>
                </li>
                <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
            </ul>
            <section class="top-bar-section">
                <ul class="left">
                    <li><a href="/en/linux/">Linux</a></li>
                    <li><a href="/en/mac/">Mac</a></li>
                    <li><a href="/en/bits/">Tips</a></li>
                    <li><a href="/en/tech/">Tech</a></li>
                    <li><a href="/en/articles/">Articles</a></li>
                    <li><a href="/en/blog/">Blog</a></li>
                    <li><a href="/en/food/">Food</a></li>
                    <li><a href="/en/pictures/">Photos</a></li>
                    <li><a href="/en/projects/">Projects</a></li>
                    <li><a href="/en/web-design/">Web Designg</a></li>
                </ul>
            </section>
        </nav> 
    </div>
</div>
<div class="row">
    <div class="large-12 columns">
        <hr>
        <p>Get updates via: <a href="/en/atom.xml" class="ss-icon ss-social-circle">rss</a> | <a href="http://twitter.com/ggarron" class="ss-icon ss-social-circle">twitter</a> | <a href="http://feedburner.google.com/fb/a/mailverify?uri=GuillermoGarronMainSite&amp;loc=en_US" class="ss-icon ss-social-circle">email</a> | <a href="https://plus.google.com/u/0/115745027821234071812" class="ss-icon ss-social-circle">google+</a></p>
        <ul class="breadcrumbs">
            
            <li><a href="/index.html">Geeking</a>
            <li class="divider">&gt;</li>
            
            <li><a href="/en/index.html">Tech Blog</a>
            <li class="divider">&gt;</li>
            
            <li><a href="/en/go2linux/index.html">Go2Linux</a>
            <li class="divider">&gt;</li>
            
            <li class="active">Increase MySQL performance with query cache query_cache</li>
        </ul>
    </div>
</div>
<div class="row">
    <div class="small-12 large-9 large-centered medium-9 medium-centered columns">
        <h3><a href="/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html">Increase MySQL performance with query cache query_cache</a></h3>
<h6>Written by <a href="/en/about.html">Guillermo Garron</a> .</h6>
<h6>Date: 2010-03-29 10:36:30 -0400</h6>

        <hr>
        <p><small>Tags: <a href="/en/tag/mysql.html">mysql</a>,</small></p>

<hr>
<p>In order to increase the performance of MySQL server, query_cache may be turned on.</p>

<p>What this is going to do is make that the queries that are repeated will be cached and not actually executed each time they are requested by the code, this aproach is really good specially for php / MySQL based web pages, if a site grows and get lots of visits a day, tunning it is a must to better use the hardware resources, and not limit the webserver because of MySQL problems.</p>

<p>Let’s see how to enable query_cache. Edit the file my.cnf and add at least these two lines.</p>

<pre><code>query_cache_type = 1 
query_cache_size = 40M
</code></pre>

<p>In the section of [mysqld] of the file, in the example, we are enabling the query_cache in the mode, where it caches all queries but the ones specifically specifying not to be cached with the directive “SQL_NO_CACHE”.</p>

<p>If we use query_cache_type = 2 the MySQL will only cache those queries that specifically asked for it, with the directive “SQL_CACHE”.</p>

<p>The query_cache_size specifies the size of the cache, you may run some tests to know if the size you are using is the appropiate.</p>

<p>Another usefull parameter is: query_cache_limit, the default value for this is 1M it tells MySQL what is the biggest query it should cache, you can modify this to fit your needs</p>

<pre><code>query_cache_limit = 2M
</code></pre>

<p>Now while running your server and your applications that uses MySQL server, enter the console with this.</p>

<pre><code>mysql -u root -p
</code></pre>

<p>Once in the console use this command to get some usefull info:</p>

<pre><code>show status like 'qc%';
</code></pre>

<p>You should get something like this:</p>

<pre><code>+-------------------------+----------+
| Variable_name           | Value    |
+-------------------------+----------+
| Qcache_free_blocks      | 2105     |
| Qcache_free_memory      | 28552504 |
| Qcache_hits             | 124244   |
| Qcache_inserts          | 40719    |
| Qcache_lowmem_prunes    | 0        |
| Qcache_not_cached       | 90       |
| Qcache_queries_in_cache | 9415     |
| Qcache_total_blocks     | 21119    |
+-------------------------+----------+
8 rows in set (0.00 sec)
</code></pre>

<p>Now, lets explain a little what these values means.</p>

<ul>
  <li>Qcache_free_memory: Is the memory free for new queries to be cached</li>
  <li>Qcache_hits: Query cache hits, shows how many queries have been served by the cache, keep an eye on thise number, the bigger the better.</li>
  <li>Qcache_inserts: Tells you how many queries have been cached, since the last time MySQL has been restarted</li>
  <li>Qcache_lowmem_prunes: This is another important number, if this number grows too fast, it means you are running out of cache memory, as it indicates how many queries have been discarted from cache, in order to insert new ones, increase the query cache size (query_cache_size) to avoid this.</li>
  <li>Qcache_queries_in_cache: The queries actually in cache.</li>
</ul>

<p>Try to review these vaules from time to time, to be able to make some tunning to your configuration, also check your system memory, you can use vmstat to know how much of it MySQL is using, so you do not run out of memory.</p>

<p>Experiment with query cache limit, and query cache size, to get the best query cache hit rate.</p>

<hr>
<a href="http://www.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html">permalink</a>
<hr>
<p>If you enjoyed the article, please share it</a>
<p><a class="ss-icon ss-social-circle" href="http://twitter.com/intent/tweet?url=http://www.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html&text=Increase MySQL performance with query cache query_cache&via=ggarron">twitter</a> | <a class="ss-icon ss-social-circle" href="http://facebook.com/sharer.php?u=http://www.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html">facebook</a> | <a class="ss-icon ss-social-circle" href="https://plus.google.com/share?url=http%3A%2F%2Fwww.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html">google+</a> | <a class="ss-icon ss-social-circle" href="http://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Fwww.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html">linkedin</a> | <a href="mailto:?Subject=Increase MySQL performance with query cache query_cache&Body=http://www.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html" class="ss-icon ss-social-circle">email</a> | <a href="http://reddit.com/submit?url=http://www.garron.me/en/go2linux/query-cache-mysql-size-limit-tunning-hit-rate.html&title=Increase MySQL performance with query cache query_cache" class="ss-icon ss-social-circle">reddit</a></p>

<hr>
<!-- <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'garronblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> -->


    </div>
</div>
      
        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <!-- <script src="/foundation/js/vendor/jquery.js"></script> -->
        <!-- <script src="/foundation/js/foundation.min.js"></script> -->
        <script src="//cdn.jsdelivr.net/foundation/5.5.1/js/foundation.min.js"></script>
        <!-- <script src="/foundation/js/rainbow.min.js"></script> -->
        <script src="//cdn.jsdelivr.net/rainbow/1.1.9/rainbow.min.js"></script>
        <!-- <script src="/bootstrap/js/magnific-popup.js"></script> -->
        <script src="//cdn.jsdelivr.net/jquery.magnific-popup/1.0.0/jquery.magnific-popup.min.js"></script>
        <!-- To start magnific popup -->
        <script src="/bootstrap/js/custom.js"></script>
        <script>
          $(document).foundation();
        </script>
        <!-- Analytics -->
        <!-- <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1514170-11']);
  _gaq.push(['_setDomainName', 'www.garron.me']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>    -->
        <!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//piwik.go2linux.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src='http://d2lx14ao1t3d4g.cloudfront.net/piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//piwik.go2linux.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->



        <!-- end analytics -->
    </body>
</html>
