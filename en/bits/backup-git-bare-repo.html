<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- SEO includes -->
        
<link href="/en/atom.xml" rel="alternate" title="Guillermo Garron" type="application/atom+xml" />


        <link rel="canonical" href="http://www.garron.me/en/bits/backup-git-bare-repo.html" />
        
<meta name="robots" content="noodp, noydir" />


<meta name="description" content="How to backup a bare git repository over ssh on another server automatically and periodically" />

        <!-- End SEO includes -->
        <title>Backup git bare repository</title>
        <!-- <link rel="stylesheet" href="/foundation/css/foundation.css" /> -->
        <link rel="stylesheet" href="//cdn.jsdelivr.net/foundation/5.5.1/css/foundation.min.css" />
        <link rel="stylesheet" href="/foundation/css/app.css">
        <link href='http://fonts.googleapis.com/css?family=Josefin+Slab|Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/webfonts/ss-social-circle.css" type="text/css">
        <!-- <link href="/bootstrap/css/magnific-popup.css" rel="stylesheet"> -->
        <link href="//cdn.jsdelivr.net/jquery.magnific-popup/1.0.0/magnific-popup.css" rel="stylesheet">
        <!-- Twitter cards -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@ggarron">
        <meta name="twitter:creator" content="@ggarron">
        <meta name="twitter:title" content="Backup git bare repository">
        <meta name="twitter:description" content="How to backup a bare git repository over ssh on another server automatically and periodically">
        <!-- End Twitter Cards -->
        <!-- FB property -->
        <meta property="fb:admins" content="613797474" />
        <!-- End FB Property -->
        <!-- <script src="/foundation/js/vendor/modernizr.js"></script> -->
        <script src="//cdn.jsdelivr.net/foundation/5.5.1/js/vendor/modernizr.js"></script>
    </head>
    <body>
        
        
        <div class="row">
    <div class="contain-to-grid sticky"> 
        <nav class="top-bar" data-topbar role="navigation" data-options="sticky_on: large">
            <ul class="title-area">
                <li class="name">
                    <h1><a href="/en/">Home</a></h1>
                </li>
                <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
            </ul>
            <section class="top-bar-section">
                <ul class="left">
                    <li><a href="/en/linux/">Linux</a></li>
                    <li><a href="/en/mac/">Mac</a></li>
                    <li><a href="/en/bits/">Tips</a></li>
                    <li><a href="/en/tech/">Tech</a></li>
                    <li><a href="/en/articles/">Articles</a></li>
                    <li><a href="/en/blog/">Blog</a></li>
                    <li><a href="/en/food/">Food</a></li>
                    <li><a href="/en/pictures/">Photos</a></li>
                    <li><a href="/en/projects/">Projects</a></li>
                    <li><a href="/en/web-design/">Web Designg</a></li>
                </ul>
            </section>
        </nav> 
    </div>
</div>
<div class="row">
    <div class="large-12 columns">
        <hr>
        <p>Get updates via: <a href="/en/atom.xml" class="ss-icon ss-social-circle">rss</a> | <a href="http://twitter.com/ggarron" class="ss-icon ss-social-circle">twitter</a> | <a href="http://feedburner.google.com/fb/a/mailverify?uri=GuillermoGarronMainSite&amp;loc=en_US" class="ss-icon ss-social-circle">email</a> | <a href="https://plus.google.com/u/0/115745027821234071812" class="ss-icon ss-social-circle">google+</a></p>
        <ul class="breadcrumbs">
            
            <li><a href="/index.html">Geeking</a>
            <li class="divider">&gt;</li>
            
            <li><a href="/en/index.html">Tech Blog</a>
            <li class="divider">&gt;</li>
            
            <li><a href="/en/bits/index.html">Tips</a>
            <li class="divider">&gt;</li>
            
            <li class="active">Backup git bare repository</li>
        </ul>
    </div>
</div>
<div class="row">
    <div class="small-12 large-9 large-centered medium-9 medium-centered columns">
        <h3><a href="/en/bits/backup-git-bare-repo.html">Backup git bare repository</a></h3>
<h6>Written by <a href="/en/about.html">Guillermo Garron</a> .</h6>
<h6>Date: 2013-06-26 19:52:13 -0400</h6>

<hr>
<h2 id="introduction">Introduction</h2>

<p>Git is great to version control your work, and it is also good that is does not have a central repository, but a distributed authority.</p>

<p>Anyway, when you create bare repository to sync the job between different contributors, you are somehow in a “virtual” way creating a centralized authority for git. Usually contributors will clone this bare repository work with it, make changes, commit them and then upload (push) them to the bare repository.</p>

<p>Before going further, let’s see what is a bare repository.</p>

<p>A git repository is usually divided in two parts, one is the history of your project, and it is made by a lot of files in a hidden folder named <strong>.git</strong>. The other part is your working folder, which is the current state of your job, as was created by git, with the info in the <strong>.git</strong> folder. In a bare repository, there is no working folder, just the history of your repository. In other words, all the info needed to create a working folder in its current state or any state it may have had in the past.</p>

<p>Bare repositories are very important when a lot of people is working on the same project. All of them can clone the bare repository with:</p>

<pre><code>git clone [bare repository url or folder]
</code></pre>

<p>Work on it, commit changes and push the changes back to the bare repository. You can read more about this in this <a href="/en/articles/git-101-basics-introduction-basic-use-commands.html">introduction to git</a> article.</p>

<p>Now that we know how important bare repositories are, you may want to know how to back it up? Being git almost a backup system by it own, you may assume that all clones are backups, and that is true. But there is another way to be sure you have a complete backup of your bare repository. <code>git clone --mirror</code>.</p>

<p>The –mirror switch will do this:</p>

<blockquote>
  <p>–mirror</p>
</blockquote>

<blockquote>
  <p>Set up a mirror of the source repository. This implies –bare. Compared to –bare, –mirror not only maps local branches of the source to local branches of the target, it maps all refs (including remote branches, notes etc.) and sets up a refspec configuration such that all these refs are overwritten by a git remote update in the target repository.</p>
</blockquote>

<h2 id="backup-a-bare-repository-with-git-clone---mirror">Backup a bare repository with git clone –mirror</h2>

<p><strong>Assumptions</strong></p>

<ul>
  <li>You have access via ssh to your bare repository</li>
  <li>You are doing the backups in another server</li>
  <li>You will be doing periodic backups automatically</li>
</ul>

<p>To use this command and backup your bare repository in a timely basis, do this.</p>

<p>We will do this in a different server, so the backup is a real backup. Let’s create a place to store it.</p>

<pre><code>mkdir ~/my-git-backup
cd ~/my-git-backup
</code></pre>

<p>Then, clone the bare respository.</p>

<pre><code>git clone --mirror user@server:/url-to-repo.git
</code></pre>

<p>Enter the ssh password, and you have your backup, it is time to enable automatic and periodic backups.</p>

<p>Prepare your server, where the backup is stored to access the one where the original bare repository is via <a href="/en/bits/ssh-key-keygen-login-no-password.html">ssh with no password</a></p>

<p>Then create a cronjob to update it every 5 minutes, edit the crontab</p>

<pre><code>crontab -e
</code></pre>

<p>And add this line at the end.</p>

<pre><code>*/5 * * * * cd ~/my-git-backup; git remote update
</code></pre>


<hr>
<a href="http://www.garron.me/en/bits/backup-git-bare-repo.html">permalink</a>
<hr>
<p>If you enjoyed the article, please share it</a>
<p><a class="ss-icon ss-social-circle" href="http://twitter.com/intent/tweet?url=http://www.garron.me/en/bits/backup-git-bare-repo.html&text=Backup git bare repository&via=ggarron">twitter</a> | <a class="ss-icon ss-social-circle" href="http://facebook.com/sharer.php?u=http://www.garron.me/en/bits/backup-git-bare-repo.html">facebook</a> | <a class="ss-icon ss-social-circle" href="https://plus.google.com/share?url=http%3A%2F%2Fwww.garron.me/en/bits/backup-git-bare-repo.html">google+</a> | <a class="ss-icon ss-social-circle" href="http://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Fwww.garron.me/en/bits/backup-git-bare-repo.html">linkedin</a> | <a href="mailto:?Subject=Backup git bare repository&Body=http://www.garron.me/en/bits/backup-git-bare-repo.html" class="ss-icon ss-social-circle">email</a> | <a href="http://reddit.com/submit?url=http://www.garron.me/en/bits/backup-git-bare-repo.html&title=Backup git bare repository" class="ss-icon ss-social-circle">reddit</a></p>

<hr>
<!-- <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'garronblog'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> -->


    </div>
</div>
      
        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <!-- <script src="/foundation/js/vendor/jquery.js"></script> -->
        <!-- <script src="/foundation/js/foundation.min.js"></script> -->
        <script src="//cdn.jsdelivr.net/foundation/5.5.1/js/foundation.min.js"></script>
        <!-- <script src="/foundation/js/rainbow.min.js"></script> -->
        <script src="//cdn.jsdelivr.net/rainbow/1.1.9/rainbow.min.js"></script>
        <!-- <script src="/bootstrap/js/magnific-popup.js"></script> -->
        <script src="//cdn.jsdelivr.net/jquery.magnific-popup/1.0.0/jquery.magnific-popup.min.js"></script>
        <!-- To start magnific popup -->
        <script src="/bootstrap/js/custom.js"></script>
        <script>
          $(document).foundation();
        </script>
        <!-- Analytics -->
        <!-- <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-1514170-11']);
  _gaq.push(['_setDomainName', 'www.garron.me']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>    -->
        <!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//piwik.go2linux.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src='http://d2lx14ao1t3d4g.cloudfront.net/piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//piwik.go2linux.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->



        <!-- end analytics -->
    </body>
</html>
